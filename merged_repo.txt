# Popraw wszystkie pliki demonów w katalogu ops\
$files = @(
  "C:\xau_rl\ops\daemon_nightly_report.ps1",
  "C:\xau_rl\ops\daemon_nightly_train.ps1",
  "C:\xau_rl\ops\daemon_feature_discovery.ps1",
  "C:\xau_rl\ops\daemon_calibration_biweekly.ps1",
  "C:\xau_rl\ops\daemon_te_calendar.ps1"
)

foreach($f in $files){
  if(Test-Path $f){
    $raw = Get-Content $f -Raw
    # Podmień błędne 'return int.TotalSeconds' na poprawne 'return int.TotalSeconds'
    $raw = $raw -replace 'return\s+int\.TotalSeconds', 'return int.TotalSeconds'
    Set-Content $f -Value $raw -Encoding UTF8
  } else {
    Write-Host "[WARN] Brak pliku: $f"
  }
}
# Odblokuj pliki (gdyby system oznaczył jako z internetu)
Get-ChildItem "C:\xau_rl\ops\daemon_*.ps1" | Unblock-File



# Popraw wszystkie pliki demonów w katalogu ops\
$files = @(
  "C:\xau_rl\ops\daemon_nightly_report.ps1",
  "C:\xau_rl\ops\daemon_nightly_train.ps1",
  "C:\xau_rl\ops\daemon_feature_discovery.ps1",
  "C:\xau_rl\ops\daemon_calibration_biweekly.ps1",
  "C:\xau_rl\ops\daemon_te_calendar.ps1"
)

foreach($f in $files){
  if(Test-Path $f){
    $raw = Get-Content $f -Raw
    # Podmień błędne 'return int.TotalSeconds' na poprawne 'return int.TotalSeconds'
    $raw = $raw -replace 'return\s+int\.TotalSeconds', 'return int.TotalSeconds'
    Set-Content $f -Value $raw -Encoding UTF8
  } else {
    Write-Host "[WARN] Brak pliku: $f"
  }
}
# Odblokuj pliki (gdyby system oznaczył jako z internetu)
Get-ChildItem "C:\xau_rl\ops\daemon_*.ps1" | Unblock-File
